import matplotlib.pyplot as plt

from yaqs.data_structures.MPO import MPO
from yaqs.data_structures.MPS import MPS
from yaqs.methods.dynamic_TDVP import dynamic_TDVP


L = 10
d = 2
J = 1
g = 0.5
dt = 0.1
timesteps = 100

psi = MPS(L)

H_0 = MPO()
H_0.init_Ising(L, d, J, g)

times = [0]
exp_values = [psi.measure_observable('x', 5)]
for n in range(timesteps):
    dynamic_TDVP(psi, H_0, dt, max_bond_dim=1024)
    times.append(n*dt)
    exp_values.append(psi.measure_observable('x', 5))

plt.plot(times, exp_values)
plt.show()